<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8"/>
  <title>RSA å›ºå®šå¯†é’¥ åŠ è§£å¯†</title>
  <script src="https://cdn.jsdelivr.net/npm/jsencrypt@3.0.0/bin/jsencrypt.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f0f2f5; color: #333; }
    .container { max-width:900px; margin:40px auto; padding:0 20px; }
    h1 { text-align:center; margin-bottom:30px; color:#444; }
    .key-size { text-align:right; font-weight:bold; margin-bottom:10px; color:#666; }
    .section { background:#fff; border-radius:8px; padding:20px; margin-bottom:20px; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
    .section h2 { margin-bottom:15px; font-size:1.2em; color:#555; border-bottom:1px solid #eee; padding-bottom:8px; }
    textarea { width:100%; height:100px; padding:10px; border:1px solid #ccc; border-radius:4px; resize:vertical; font-family:monospace; font-size:0.95em; background:#fafafa; }
    .buttons { margin-top:10px; }
    button { background:#4a90e2; color:#fff; border:none; border-radius:4px; padding:8px 16px; font-size:0.95em; cursor:pointer; transition:background 0.2s; }
    button:hover { background:#357ab8; }
    button + button { margin-left:10px; }
    .key-blocks { display:flex; gap:20px; flex-wrap:wrap; }
    .key-card { flex:1 1 45%; display:flex; flex-direction:column; }
    .key-card textarea { height:140px; }
    .key-card button { align-self:flex-end; margin-top:8px; }
  </style>
</head>
<body>

  <div class="container">
    <h1>ğŸ” RSA å›ºå®šå¯†é’¥ åŠ è§£å¯†</h1>
    <div class="key-size">ğŸ”‘ å½“å‰å¯†é’¥ä½æ•°ï¼š1024 bits</div>

    <div class="section">
      <h2>æ˜æ–‡è¾“å…¥</h2>
      <textarea id="plainText" placeholder="è¯·è¾“å…¥è¦åŠ å¯†çš„å†…å®¹ï¼ˆå¦‚ abc æˆ– ä½ å¥½ï¼‰"></textarea>
      <div class="buttons">
        <button onclick="doEncrypt()">åŠ å¯†</button>
        <button onclick="clearText('plainText')">æ¸…ç©º</button>
      </div>
    </div>

    <div class="section">
      <h2>å¯†æ–‡è¾“å‡ºï¼ˆBase64ï¼‰</h2>
      <textarea id="cipherOutput" placeholder="åŠ å¯†åçš„å¯†æ–‡ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ"></textarea>
      <div class="buttons">
        <button onclick="copyToClipboard('cipherOutput', this)">å¤åˆ¶å¯†æ–‡</button>
        <button onclick="clearText('cipherOutput')">æ¸…ç©º</button>
      </div>
    </div>

    <div class="section">
      <h2>å¯†æ–‡è¾“å…¥</h2>
      <textarea id="cipherInput" placeholder="è¯·ç²˜è´´è¦è§£å¯†çš„å¯†æ–‡"></textarea>
      <div class="buttons">
        <button onclick="doDecrypt()">è§£å¯†</button>
        <button onclick="clearText('cipherInput')">æ¸…ç©º</button>
      </div>
    </div>

    <div class="section">
      <h2>è§£å¯†è¾“å‡ºï¼ˆæ˜æ–‡ï¼‰</h2>
      <textarea id="decryptedText" placeholder="è§£å¯†ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ"></textarea>
      <div class="buttons">
        <button onclick="copyToClipboard('decryptedText', this)">å¤åˆ¶æ˜æ–‡</button>
        <button onclick="clearText('decryptedText')">æ¸…ç©º</button>
      </div>
    </div>

    <div class="section">
      <h2>å›ºå®šçš„å…¬é’¥ / ç§é’¥</h2>
      <div class="key-blocks">
        <div class="key-card">
          <strong>å…¬é’¥ï¼š</strong>
          <textarea id="publicKey" readonly>-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC+9i5HpVULuzTmheEwqv+zzwz3
W+fZcU7tYxhAt5tQQNwa+kRY1k0UeIpPmdI5dW2VDFn2sjRr/vi7ZvkumQAKvyWA
bi+oys3bFzbtS5LzYXW/z2SyeIHI0JA84rj8WPcOb2pm+7Yh8smF1AiodfDCJPGY
P+goniNFykd5skTcUQIDAQAB
-----END PUBLIC KEY-----</textarea>
          <button onclick="copyToClipboard('publicKey', this)">å¤åˆ¶å…¬é’¥</button>
        </div>
        <div class="key-card">
          <strong>ç§é’¥ï¼š</strong>
          <textarea id="privateKey" readonly>-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQC+9i5HpVULuzTmheEwqv+zzwz3W+fZcU7tYxhAt5tQQNwa+kRY
1k0UeIpPmdI5dW2VDFn2sjRr/vi7ZvkumQAKvyWAbi+oys3bFzbtS5LzYXW/z2Sy
eIHI0JA84rj8WPcOb2pm+7Yh8smF1AiodfDCJPGYP+goniNFykd5skTcUQIDAQAB
AoGALbPzrZgHO7CJX6apF6HFYv5p5wWq/qKctjniQxLubA2p4BcHpo9bkUusJpL0
+mV9XY/ANEfAPhye4RMrDhj2JjJY1B1Rne5K9er2fothLlhSAAN+FYc7GQje4C3X
LuBzU7LfkTEwPhxkkLDqyL/mXPeUuqx5YzfzfL02iFDoHAECQQDnh6b5ZSHT27NY
4Dq8GoFciPRTtJw7S+GDQeDho5uQ6uT4LxYm4pKcrIvrpM8oBnnhvlvmvXQB9b32
MqCB5nzBAkEA0yTmoAfb0hgZURO03SHAQWf7lyOCza09oECmDwhG0fexTgx0xl/7
1Iby/viS/0sinDBgFrSTpttXaHAXoI3zkQJARLIOC89C4y47n3IgWzFuEnucKr3a
4QkZpy1DwQ8fGDdpqm2mH/F32L6lYUxsHo8VWLJ3aBXsNqyoKUVKNGCjwQJBAJKy
N52F+D8OyUAgXe+pTGbk9NK8NFvr+j4FzJnzGSk2WzSryNIuy8uL+vYVBCRlMmWr
4obD7TXnfOItxuyg01ECQGt14o5eUyXRnhl/wzaNyLqnlFUBbUgqkS0c1lb3yOWx
lVU+hxWkDIPd06XslMldqnKAR/A+QY20/o97TE8XbHg=
-----END RSA PRIVATE KEY-----</textarea>
          <button onclick="copyToClipboard('privateKey', this)">å¤åˆ¶ç§é’¥</button>
        </div>
      </div>
    </div>
  </div>

<script>
  const publicKeyPEM = document.getElementById('publicKey').value.trim();
  const privateKeyPEM = document.getElementById('privateKey').value.trim();

  function doEncrypt() {
    const plain = document.getElementById('plainText').value;
    if (!plain) { alert('è¯·è¾“å…¥æ˜æ–‡'); return; }
    const encryptor = new JSEncrypt({ default_key_size: 1024 });
    encryptor.setPublicKey(publicKeyPEM);
    const cipher = encryptor.encrypt(plain);
    if (!cipher) {
      alert('åŠ å¯†å¤±è´¥ï¼šæ–‡æœ¬è¿‡é•¿æˆ–å…¬é’¥æ ¼å¼é”™è¯¯');
      return;
    }
    document.getElementById('cipherOutput').value = cipher;
  }

  function doDecrypt() {
    const cipher = document.getElementById('cipherInput').value.trim();
    if (!cipher) { alert('è¯·è¾“å…¥å¯†æ–‡'); return; }
    const decryptor = new JSEncrypt();
    decryptor.setPrivateKey(privateKeyPEM);
    const result = decryptor.decrypt(cipher);
    if (result === false) {
      alert('è§£å¯†å¤±è´¥ï¼šå¯†æ–‡æˆ–ç§é’¥ä¸åŒ¹é…');
      return;
    }
    document.getElementById('decryptedText').value = result;
  }

  function copyToClipboard(id, btn) {
    const ta = document.getElementById(id);
    ta.select();
    document.execCommand('copy');
    const original = btn.textContent;
    btn.textContent = 'å·²å¤åˆ¶';
    setTimeout(() => btn.textContent = original, 1000);
  }

  function clearText(id) {
    const ta = document.getElementById(id);
    if (ta) ta.value = '';
  }
</script>

</body>
</html>
